<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Bypassing Whitelists using Double Extensions in File Uploads</title>
</head><body><img src="1.png" /><br/>
<br/>
<br/>
In questo caso, permettiamo solo file di tipo .gif,<br/>
con tipo nella richiesta "image/gif" (anche se è spoofabile)<br/>
e alla fine controllo se l'estensione è quella permessa.<br/>
<br/>
<br/>
Pure se rinominassi una backdoor.php in una backdoor.gif,<br/>
ci darebbe un errore di utilizzo:<br/>
<img src="1 2.png" /><br/>
<br/>
<br/>
Nel caso di doppia estensione:<ul><li>Se non è importante l'encoding, è indifferente l'ordine:</li>
<li>E.G. welcome.html.ita e welcome.ita.html vengono mappati sempre come "text/html"</li>
<li>Nel caso siano rilevanti per l'encoding le estensioni, <b>l'ultima a destra è utilizzata è rilevante:</b></li>
<li>E.G. welcome.gif.html è associato al MIME type "text/html" e non a "image/gif"</li>
</ul>
<ul><li>https://httpd.apache.org/docs/2.4/mod/mod_mime.html</li>
</ul>
<img src="1 3.png" /><br/>
<br/>
02:29</body></html>